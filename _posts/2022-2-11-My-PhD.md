---
layout: post
title: How does FFT helps in micromagnetic simulations
published: true
---

In micromagnetic simulations, FFT is particularly helpful in calculating magnetostatic (dipolar) interactions.

Magnetostatic interactions are long-range interactions that arise due to the presence of magnetic charges on the surfaces of magnetic domains. These interactions have a significant influence on the overall behavior of magnetic materials, including domain formation, domain wall motion, and magnetization dynamics. Accurate calculation of magnetostatic interactions is crucial for reliable micromagnetic simulations.

Computing magnetostatic interactions directly in the spatial domain can be computationally expensive, especially for large systems or fine discretization grids. However, using FFT (fast Fourier transform), it is possible to perform these calculations more efficiently in the frequency domain. _But be careful_, even with the use of the FFT, the micromagnetic simulations can still be extremely time-consuming and the calculation of this interaction terms is still the main source of long simulation time: For example for simulation of a spin-torque nano-oscillator with size of ~100 nm, the simulation time could be in the order of minutes to hours without magnetostatic field, and could range from a few hours to a day or more With magnetostatic field (depending on the mesh resolution, simulation settings, and the hardware resources available)

_That's why, My project of exploring another method seeks to solve this long simulation time problem!_



### Calculation of demagnetization field

The demagnetization field, which can be derived from the Maxwell equation (checkout [my theis](https://theses.hal.science/tel-03770225/document) for the derivation), can be expressed as (neglecting the coefficient):

\\[
H_\text{demag}(\mathbf{r}) = \int \frac{\rho_m(\mathbf{r'})}{|\mathbf{r} - \mathbf{r'}|^3} (\mathbf{r} - \mathbf{r'}) d\mathbf{r'}
\\]

where \\(\rho_m = -\nabla \cdot \mathbf{M}\\) is the charge density. Using the Green's function, it can be further expressed as: 


\[
\mathbf{B}_\text{demag}(\mathbf{r}) = \int_{V'} \nabla G(\mathbf{r}, \mathbf{r'}) \rho_m(\mathbf{r'}) dV'
\]

Recalling the formation of [_Convolution of two functions_](https://en.wikipedia.org/wiki/Convolution), we hereby obtain a simplified verion of the expressionï¼š




The basic idea is to transform both the magnetization and the interaction kernel from the spatial domain to the frequency domain using FFT. Then, the product of the transformed magnetization and the transformed interaction kernel is calculated element-wise. Finally, the inverse FFT is applied to this product to obtain the magnetostatic field in the spatial domain. 


This procedure is done in descretized cells in simulation softwares such as Mumax or OOMMF. More specifically, discretized magnetostatic field in the x-direction (for example) for each cell in the spatial domain can be expressed as:



asdfsadf


This is a display math example:
$$
E=mc^2
$$

This is an inline math example: \\(E=mc^2\\)

This is a display math example:
\\[
E=mc^2
\\]

$\sqrt{3x-1}+(1+x)^2$


gfyfyhj







![_config.yml]({{ site.baseurl }}/images/fft_demag.png)
